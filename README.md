# GPT-2 Fine-Tuning on BBC News and glue/mrpc Dataset

## Overview
This project leverages the GPT-2 language model, a cutting-edge generative model known for its ability to generate coherent, contextually relevant text. We fine-tune GPT-2 on the BBC News dataset, which consists of diverse news articles, to enhance the model's ability to generate news-style text and analyze prompts in this specific context.

## How to Start
You will need to run the following command to install dependencies:
```shell
pip install -r requirement.txt
```
## Repository Structure
- **Training Code**: [`gpt2_train_on_bbc.py`](./gpt2_train_on_bbc.py)
- **Evaluation Code**: [`evl.py`](./evl.py)
- **Dataset Directory**: `bbc-news/`from https://huggingface.co/datasets/SetFit/bbc-news and glue/mrpc from huggingface
- **Model and Tokenizer Directories**: 
  - Model: `local-gpt2-model/`
  - Tokenizer: `local-gpt2-tokenizer/`
- **Trained Model Path**: The model, post-training, is stored in `output/gpt2_train.pth`.

---

## Fine-Tuning and Evaluation Process

### Training

In the training phase, we fine-tune GPT-2 using several key hyperparameters and an optimized setup. The main parameters include:

- **Epochs**: Number of passes through the dataset we set total epochs=100 for bbc-news and epochs=10 for glue/mrpc
- **Learning Rate**: The step size for gradient descent, set to ensure stability and performance.Here we set lr=1-e5
- **Optimizer**: We employ AdamW, an efficient optimization method for handling sparse gradients.

To start training, use the following command:
```bash
python gpt2_train_on_bbc.py
```
Also, we fine-tune GPT-2 using glue/mrpc
To start training, use the following command:
```bash
python gpt2_train_on_mrpc.py
```

### Evaluation

For model evaluation, we use `evl.py`, which accepts user-provided prompts and generates outputs based on the fine-tuned model. The max tokens to be generated is set to 200. The evaluation command is as follows:
```bash
python evl.py <prompt>
```

**Example Evaluations**

Below are five example prompts and the corresponding outputs generated by the fine-tuned model training on bbc-news:

1. **Prompt**: "good morning"
   - **Generated Text**: "good morning for british music the british pop scene is celebrating its 10th anniversary this weekend  but what is so special about it all  and why are so many so many so-called great british bands still performing   is the sheer number of acts on the bill in the wee hours of the morning.   i m just here to kick start things off by having a bang with some of the best british music in the world   says jamelia  jamelia s new single  which is out now on the uk s top chart. it s called  the best british christmas album  and it s out now on 100 charts. jamelia s  which is about real people  real people  real people being real people and real people being fiction  is the band s response to a song by real people singer jamelia hayley that has become a best-selling album in the british music world. it s called 
"

2. **Prompt**: "china"
   - **Generated Text**: " china s booming economy china s economy grew by 6.5% in 2004  faster than predicted and well above 2003 s 5.1%.  the figure is the fastest rate of growth in five years and the second-fastest in five years. growth in china has been stuck in the double digits for years  with unemployment stuck above 10% for years. but officials said the pace of economic growth was improving and that growth was continuing unabated.  the government has made steady progress on curbing the power of central banks  known as pan-democratic reform committees (prc). in a speech in china  deputy prime minister li zhaoxing said prc members had  fully implemented the central bank policy . but he warned that the pace of economic growth was  still fragile  and that china s economic growth was slowing.  i fear that the pace of economic growth will slow considerably in 2005   mr li told the bbc s world at
"

3. **Prompt**: " soccer game is exciting"
   - **Generated Text**: "soccer game is exciting but not everyone is convinced america will become world number one this summer  according to a new study.  the american women s national team s win in san jose on tuesday night was the uk s biggest single moment of the tournament. but the overwhelming majority of us fans do not believe that america will become world number one in the near future  according to a new poll. the poll  conducted by sports pundit  sports reporter  andrew marr  looked at the five main factors behind the overwhelming majority of us voting to select the six nations.  america is the obvious choice  but the overwhelming majority of us fans do not believe that america can win the women s game   said marr.  the overwhelming majority of us voters (92%) think that the defending champions are the better team and that the americans are the better team.  but the overwhelming majority of us fans (92%) also do not agree that the
"

4. **Prompt**: "british prime minister"
   - **Generated Text**: "british prime minister tony blair has defended his handling of the asian tsunami disaster  saying he was not  overwhelmed  by the scale of the disaster.  the prime minister was speaking after a meeting of the g8 group of leading industrialised nations in brussels. mr blair said the disaster had been  very difficult  but he was not  overwhelmed . he said the disaster had been personal  and he hoped other premiers would too.  the meeting came as g8 ministers held their third meeting of the year to discuss the world economy and world affairs. the meeting came after mr blair said he had agreed to hold a summit of the g8 group of leading industrialised nations in the hope of averting another world recession. he said he accepted the call but said he would not accept  any compromise  on the issue.  the g8 meeting comes as g7 members attempt to hammer out a deal on debt relief for the world s poorest countries
"

5. **Prompt**: "pop music"
   - **Generated Text**: "pop music  not a genre  the british pop act  which debuted at number one in the uk in 2000  is not a genre bollywood flick.  it s not a genre bollywood flick  it s a pop act   said jamie cullum  who plays the lead singer. the pop act  which has sold more than a million copies in the last three years  have recently released two new albums  one of which is about to be released as a single.  we ve been doing this for a long time and i think we ve done quite a few hits   said jamie cullum.  we ve done a couple of really good hits  like the new order and you know you get a lot of new bands coming out here and suddenly you realise there s not a lot of really great tunes.   we ve done a couple of really good hits  like new order  but you know you don t really get that sort of pop appeal from
"

Below are five example prompts and the corresponding outputs generated by the fine-tuned model training on mrpc:
1. **Prompt**: "chinese"
   - **Generated Text**: "chinese officials have said they will not allow the shipment of the weapons to the United States , which has said it will not support the shipment . Chinese officials have said they will not allow the shipment of the weapons to the United States , which has said it will not support the shipment .
"

2. **Prompt**: "pop music"
   - **Generated Text**: "pop music is a popular form of entertainment , and it has a long history in the United States . But it has a long history in the United States , and it has a long history in the United States .
"

3. **Prompt**: " lebron james is the best basketball player"
   - **Generated Text**: "lebron james is the best basketball player in the world , and he is the best coach in the world . Bryant is the best basketball player in the world , and he is the best coach in the world .
"

4. **Prompt**: "british prime minister"
   - **Generated Text**: "british prime minister Yasser Arafat has called for a boycott of the talks . Prime Minister Yasser Arafat has called for a boycott of the talks .
"

5. **Prompt**: "american"
   - **Generated Text**: "american President Juan Manuel Santos has said he will sign the treaty if it is ratified . Colombian President Juan Manuel S. Santos has said he will sign the treaty if it is ratified .
"
## Comparison
As a comparison, the model trained on glue/mrpc has more reasonable and fluent answer than the model trained on bbc-news, the difference is caused by the quality and the size of the training set 
